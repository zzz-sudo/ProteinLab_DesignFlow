是的，你观察得很仔细，这里的“峰值比对”其实就是 ProteinMPNN 内部的打分机制在起作用，不过要区分几个概念：

---

### 1️⃣ MSA 阶段的保守性 vs MPNN 的峰值比对

* **MSA 阶段**

  * 你生成同源序列集合（A3M）
  * 统计每个位点的氨基酸频率 → 得到保守位点
  * 目的是**生成固定 JSON**，告诉 MPNN 哪些位置不能改

* **ProteinMPNN 生成序列阶段**

  * 内部每个候选序列都会计算**log-likelihood / probability score**
  * 这个分值就是你说的“峰值比对”，反映序列与骨架的匹配程度
  * 如果某个位点固定了，它不会影响分值计算，但其它位点会被评估

---

### 2️⃣ 为什么看起来在“生成序列的时候已经比对”

* 因为 MPNN 在生成序列的同时就计算每个候选序列的分值
* 所以你会觉得“序列一生成就有峰值分数”，其实是**评分和生成同时发生**
* 这个分值之后才用来筛选 top N 序列送 AlphaFold2 预测

---

### 3️⃣ 总结

| 阶段          | 做什么       | 输出         | 是否影响序列生成      |
| ----------- | --------- | ---------- | ------------- |
| MSA         | 保守性统计     | 固定位点 JSON  | 是（冻结高保守位点）    |
| ProteinMPNN | 生成序列 + 打分 | 序列 + score | 是（score 用于筛选） |
| AlphaFold2  | 结构预测      | PDB 结构     | 否（只是验证）       |

---

换句话说，**序列生成阶段的“比对”只是 MPNN 自己的评分，不是 MSA 的比对**。

如果你愿意，我可以帮你画一个图，把 MSA、JSON、MPNN 生成、评分、筛选整个流程可视化，让你一眼就能看到“什么时候冻结、什么时候评分、什么时候送预测”。

你希望我画吗？
